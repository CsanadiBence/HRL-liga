<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mentett bajnoks√°gok | HunRise Legacy</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <nav class="navbar">
            <div class="logo-container">
                <img src="kislogo.png" alt="HunRise Logo" class="nav-logo">
                <div class="logo-text">HunRise <span>Legacy</span></div>
            </div>
            <a href="bajnoksag/index.html" class="nav-link-main">Bajnoks√°gok</a>
            
            <button class="hamburger" id="hamburgerBtn">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <div class="nav-menu" id="navMenu">
                <a href="index.html" class="nav-menu-link">R√≥lunk</a>
                <a href="players.html" class="nav-menu-link">J√°t√©kosok</a>
                <a href="archives.html" class="nav-menu-link">üìú Mentett bajnoks√°gok</a>
                <div class="admin-section">
                    <div id="adminLoggedOut" class="admin-form">
                        <input type="password" id="adminPassword" placeholder="Admin jelsz√≥" class="admin-input">
                        <button id="adminLoginBtn" class="admin-btn">Bejelentkez√©s</button>
                    </div>
                    <div id="adminLoggedIn" style="display: none;" class="admin-active">
                        <span class="admin-status">‚úì Admin m√≥d</span>
                        <button id="adminLogoutBtn" class="admin-logout">Kil√©p√©s</button>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <section class="archives-section">
        <div class="container">
            <a href="index.html" style="display: inline-block; margin-bottom: 30px; color: #00d4ff; text-decoration: none; font-weight: 700; transition: 0.3s;">‚Üê Vissza a f≈ëoldalra</a>
            <h1 style="text-align: center; margin-bottom: 15px;">Mentett bajnoks√°gok</h1>
            <p class="section-subtitle">Lez√°rt szezonok √©s eredm√©nyek</p>
            <div id="archiveList" class="archive-cards" style="margin-top: 40px;"></div>
        </div>
    </section>

    <script src="app.js"></script>
    <script>
        // Archives oldal specifikus bet√∂lt√©s
        document.addEventListener('DOMContentLoaded', function() {
            renderArchivesPage();
        });

        async function renderArchivesPage() {
            const listEl = document.getElementById('archiveList');
            if (!listEl) return;

            try {
                const url = `https://firestore.googleapis.com/v1/projects/${FIREBASE_PROJECT_ID}/databases/(default)/documents/archives?pageSize=50`;
                const response = await fetch(url, {
                    headers: { 'Authorization': `Bearer ${FIREBASE_API_KEY}` }
                });

                if (!response.ok) {
                    listEl.innerHTML = '<p class="muted" style="text-align: center; grid-column: 1/-1; padding: 40px;">M√©g nincs mentett bajnoks√°g.</p>';
                    return;
                }

                const data = await response.json();
                const documents = data.documents || [];

                if (documents.length === 0) {
                    listEl.innerHTML = '<p class="muted" style="text-align: center; grid-column: 1/-1; padding: 40px;">M√©g nincs mentett bajnoks√°g.</p>';
                    return;
                }

                listEl.innerHTML = documents.map(doc => {
                    const fields = doc.fields || {};
                    const name = fields.name?.stringValue || 'Ismeretlen bajnoks√°g';
                    const finishedAt = fields.finishedAt?.timestampValue 
                        ? new Date(fields.finishedAt.timestampValue).toLocaleDateString('hu-HU')
                        : '-';
                    const champion = fields.champion?.mapValue?.fields || {};
                    const champ = champion.winnerName?.stringValue || '-';
                    const pairing = champion.pairing?.stringValue || 'Nincs d√∂nt≈ë r√∂gz√≠tve';
                    const score = champion.finalScore?.stringValue ? ` (${champion.finalScore.stringValue})` : '';

                    return `
                        <div class="archive-card">
                            <div class="archive-head">
                                <h3>${name}</h3>
                                <span class="archive-date">${finishedAt}</span>
                            </div>
                            <p class="archive-champ">Bajnok: ${champ}</p>
                            <p class="archive-final">D√∂nt≈ë: ${pairing}${score}</p>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error("Arch√≠vum bet√∂lt√©si hiba:", error);
                listEl.innerHTML = '<p class="muted" style="text-align: center; grid-column: 1/-1; padding: 40px;">Hiba az arch√≠vum bet√∂lt√©sekor. K√©s≈ëbb pr√≥b√°lkozz.</p>';
            }
        }
    </script>
</body>
</html>
